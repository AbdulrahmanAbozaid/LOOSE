import { Router } from "express";
import AuthController from "../../controller/authController/user_auth_controller";
import * as userController from "../../controller/user.controller";
import { authorize, restrictTo } from "../../utils/auth.service";
const router = Router();
router.post('/', AuthController.signup);
router.post("/auth/login", AuthController.login);
router.post("/auth/forgot-password", AuthController.forgotPassword);
router.post("/auth/verify-forgot-password-otp/:OTP", AuthController.verifyForgotPasswordOTP);
router.post("/auth/reset-password/:token", AuthController.resetPassword);
router.post("/:id/password/", AuthController.changePassword);
router.get('/', authorize, restrictTo("Admin"), userController.getUsers);
router.get('/:id', authorize, userController.getUserById);
router.put('/:id', authorize, userController.updateUser);
router.delete('/:id', authorize, restrictTo("Admin"), userController.deleteUser);
router.get('/:id/cart', authorize, userController.getUserCart);
router.put('/:id/cart', authorize, userController.updateUserCart);
router.post('/:id/cart', authorize, userController.addUserCart);
router.patch('/:id/cart', authorize, userController.checkoutCart);
router.post('/favorites/add', authorize, userController.addToFavs);
router.delete('/favorites/remove', authorize, userController.removeFromFavs);
router.get('/:id/favorites', authorize, userController.getUserFavorites);
export default router;
